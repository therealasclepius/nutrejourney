<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutre Meals - National Coverage Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #0a0a0a; color: #fff; }
        
        .header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            padding: 25px 30px;
        }
        .header h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
        .header .subtitle { font-size: 15px; opacity: 0.9; }
        
        .stats-banner {
            background: #1a1a1a;
            padding: 20px 30px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            border-bottom: 1px solid #333;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #10b981;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .container { display: flex; height: calc(100vh - 180px); }
        #map { flex: 1; height: 100%; }
        
        .sidebar {
            width: 380px;
            background: #1a1a1a;
            padding: 25px;
            overflow-y: auto;
            border-left: 1px solid #333;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section h3 {
            font-size: 14px;
            color: #10b981;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
        }
        
        .market-tier {
            background: #252525;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid;
        }
        
        .tier-core { border-color: #10b981; }
        .tier-growth { border-color: #3b82f6; }
        .tier-emerging { border-color: #f59e0b; }
        .tier-test { border-color: #6b7280; }
        
        .tier-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .tier-name {
            font-size: 13px;
            font-weight: 700;
        }
        
        .tier-count {
            font-size: 11px;
            color: #9ca3af;
        }
        
        .tier-stats {
            font-size: 12px;
            color: #d1d5db;
            line-height: 1.6;
        }
        
        .state-list {
            background: #1f2937;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .state-list h4 {
            font-size: 12px;
            color: #10b981;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        
        .state-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 12px;
            border-bottom: 1px solid #374151;
        }
        
        .state-row:last-child { border-bottom: none; }
        
        .state-name { color: #e5e7eb; }
        .state-revenue { color: #10b981; font-weight: 600; }
        
        /* Popup Styles */
        .leaflet-popup-content-wrapper { background: #1a1a1a; color: #fff; border-radius: 8px; }
        .leaflet-popup-content { margin: 15px; font-size: 13px; min-width: 280px; }
        .leaflet-popup-tip { background: #1a1a1a; }
        
        .popup-header {
            padding-bottom: 12px;
            border-bottom: 2px solid #10b981;
            margin-bottom: 12px;
        }
        
        .popup-state { font-size: 20px; font-weight: 700; color: #10b981; }
        .popup-tier { font-size: 11px; color: #9ca3af; text-transform: uppercase; margin-top: 4px; }
        
        .metric-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 12px 0;
        }
        
        .metric-box {
            background: #252525;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 11px;
            color: #9ca3af;
            margin-bottom: 4px;
            text-transform: uppercase;
        }
        
        .metric-value {
            font-size: 16px;
            font-weight: 700;
            color: #fff;
        }
        
        @media (max-width: 768px) {
            .stats-banner { grid-template-columns: repeat(2, 1fr); }
            .container { flex-direction: column; }
            .sidebar { width: 100%; height: 400px; border-left: none; border-top: 1px solid #333; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üó∫Ô∏è Nutre Meals - National Coverage</h1>
        <div class="subtitle">29 States ‚Ä¢ $20.9M YTD Revenue ‚Ä¢ 12,181 Customers</div>
    </div>
    
    <div class="stats-banner">
        <div class="stat-item">
            <div class="stat-value">$20.9M</div>
            <div class="stat-label">Total Revenue</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">185,924</div>
            <div class="stat-label">Total Orders</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">12,181</div>
            <div class="stat-label">Customers</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">$110.78</div>
            <div class="stat-label">Average AOV</div>
        </div>
    </div>
    
    <div class="container">
        <div id="map"></div>
        
        <div class="sidebar">
            <div class="section">
                <h3>Market Tiers</h3>
                
                <div class="market-tier tier-core">
                    <div class="tier-header">
                        <span class="tier-name" style="color: #10b981;">CORE MARKETS</span>
                        <span class="tier-count">5 States</span>
                    </div>
                    <div class="tier-stats">
                        ‚Ä¢ $18.3M (88% of revenue)<br>
                        ‚Ä¢ 9,514 customers<br>
                        ‚Ä¢ MA, NY, NH, NJ, CT
                    </div>
                </div>
                
                <div class="market-tier tier-growth">
                    <div class="tier-header">
                        <span class="tier-name" style="color: #3b82f6;">GROWTH MARKETS</span>
                        <span class="tier-count">6 States</span>
                    </div>
                    <div class="tier-stats">
                        ‚Ä¢ $2.0M (9.6% of revenue)<br>
                        ‚Ä¢ 2,011 customers<br>
                        ‚Ä¢ RI, FL, PA, VA, ME, GA
                    </div>
                </div>
                
                <div class="market-tier tier-emerging">
                    <div class="tier-header">
                        <span class="tier-name" style="color: #f59e0b;">EMERGING MARKETS</span>
                        <span class="tier-count">15 States</span>
                    </div>
                    <div class="tier-stats">
                        ‚Ä¢ $529K (2.5% of revenue)<br>
                        ‚Ä¢ 638 customers<br>
                        ‚Ä¢ NC, MD, TN, OH, IL, VT, MI, DC, DE, TX, WI, WV, KY, SC + more
                    </div>
                </div>
                
                <div class="market-tier tier-test">
                    <div class="tier-header">
                        <span class="tier-name" style="color: #6b7280;">TEST MARKETS</span>
                        <span class="tier-count">3 States</span>
                    </div>
                    <div class="tier-stats">
                        ‚Ä¢ $11K (<0.1% of revenue)<br>
                        ‚Ä¢ 30 customers<br>
                        ‚Ä¢ IN, MO, CA
                    </div>
                </div>
            </div>
            
            <div class="state-list">
                <h4>Top 10 Markets by Revenue</h4>
                <div class="state-row">
                    <span class="state-name">1. Massachusetts</span>
                    <span class="state-revenue">$12.5M</span>
                </div>
                <div class="state-row">
                    <span class="state-name">2. New York</span>
                    <span class="state-revenue">$1.95M</span>
                </div>
                <div class="state-row">
                    <span class="state-name">3. New Hampshire</span>
                    <span class="state-revenue">$1.67M</span>
                </div>
                <div class="state-row">
                    <span class="state-name">4. New Jersey</span>
                    <span class="state-revenue">$1.22M</span>
                </div>
                <div class="state-row">
                    <span class="state-name">5. Connecticut</span>
                    <span class="state-revenue">$1.02M</span>
                </div>
                <div class="state-row">
                    <span class="state-name">6. Rhode Island</span>
                    <span class="state-revenue">$665K</span>
                </div>
                <div class="state-row">
                    <span class="state-name">7. Florida</span>
                    <span class="state-revenue">$489K</span>
                </div>
                <div class="state-row">
                    <span class="state-name">8. Pennsylvania</span>
                    <span class="state-revenue">$397K</span>
                </div>
                <div class="state-row">
                    <span class="state-name">9. Virginia</span>
                    <span class="state-revenue">$190K</span>
                </div>
                <div class="state-row">
                    <span class="state-name">10. Maine</span>
                    <span class="state-revenue">$140K</span>
                </div>
            </div>
            
            <div class="section" style="background: #1f2937; padding: 15px; border-radius: 8px; border-left: 3px solid #10b981;">
                <h3 style="margin-bottom: 10px;">üí° Coverage Insights</h3>
                <ul style="font-size: 12px; line-height: 1.8; color: #d1d5db; list-style: none; padding: 0;">
                    <li>‚Üí 59.8% of revenue from MA alone</li>
                    <li>‚Üí Northeast = 88% of total business</li>
                    <li>‚Üí Strong expansion in FL (688 customers)</li>
                    <li>‚Üí MD/VA/DC need strengthening vs F&F</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([39.5, -80.0], 5);
        
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 20
        }).addTo(map);

        var nutreStates = [
            // Core Markets
            {state: 'MA', name: 'Massachusetts', coords: [42.3601, -71.0589], revenue: 12484131, customers: 5747, orders: 111901, tier: 'Core', color: '#10b981', size: 32},
            {state: 'NY', name: 'New York', coords: [40.7128, -74.0060], revenue: 1951830, customers: 1402, orders: 17304, tier: 'Core', color: '#10b981', size: 24},
            {state: 'NH', name: 'New Hampshire', coords: [43.2081, -71.5376], revenue: 1674471, customers: 874, orders: 14489, tier: 'Core', color: '#10b981', size: 22},
            {state: 'NJ', name: 'New Jersey', coords: [40.0583, -74.4057], revenue: 1219848, customers: 1019, orders: 11232, tier: 'Core', color: '#10b981', size: 20},
            {state: 'CT', name: 'Connecticut', coords: [41.6032, -73.0877], revenue: 1018962, customers: 472, orders: 8573, tier: 'Core', color: '#10b981', size: 18},
            
            // Growth Markets
            {state: 'RI', name: 'Rhode Island', coords: [41.8240, -71.4128], revenue: 664569, customers: 382, orders: 5773, tier: 'Growth', color: '#3b82f6', size: 16},
            {state: 'FL', name: 'Florida', coords: [27.9944, -81.7603], revenue: 489126, customers: 688, orders: 4738, tier: 'Growth', color: '#3b82f6', size: 15},
            {state: 'PA', name: 'Pennsylvania', coords: [40.2732, -76.8867], revenue: 397318, customers: 351, orders: 3588, tier: 'Growth', color: '#3b82f6', size: 14},
            {state: 'VA', name: 'Virginia', coords: [37.5407, -77.4360], revenue: 190413, customers: 224, orders: 1700, tier: 'Growth', color: '#3b82f6', size: 12},
            {state: 'ME', name: 'Maine', coords: [44.3106, -69.7795], revenue: 140148, customers: 138, orders: 1156, tier: 'Growth', color: '#3b82f6', size: 11},
            {state: 'GA', name: 'Georgia', coords: [33.7490, -84.3880], revenue: 117644, customers: 118, orders: 923, tier: 'Growth', color: '#3b82f6', size: 10},
            
            // Emerging Markets
            {state: 'NC', name: 'North Carolina', coords: [35.7796, -78.6382], revenue: 88203, customers: 106, orders: 743, tier: 'Emerging', color: '#f59e0b', size: 9},
            {state: 'MD', name: 'Maryland', coords: [39.0458, -76.6413], revenue: 85621, customers: 140, orders: 677, tier: 'Emerging', color: '#f59e0b', size: 9},
            {state: 'TN', name: 'Tennessee', coords: [36.1627, -86.7816], revenue: 59891, customers: 85, orders: 641, tier: 'Emerging', color: '#f59e0b', size: 8},
            {state: 'OH', name: 'Ohio', coords: [39.9612, -82.9988], revenue: 48207, customers: 78, orders: 451, tier: 'Emerging', color: '#f59e0b', size: 7},
            {state: 'IL', name: 'Illinois', coords: [41.8781, -87.6298], revenue: 39313, customers: 82, orders: 348, tier: 'Emerging', color: '#f59e0b', size: 7},
            {state: 'VT', name: 'Vermont', coords: [44.2601, -72.5754], revenue: 33421, customers: 32, orders: 272, tier: 'Emerging', color: '#f59e0b', size: 6},
            {state: 'MI', name: 'Michigan', coords: [42.7325, -84.5555], revenue: 31957, customers: 56, orders: 260, tier: 'Emerging', color: '#f59e0b', size: 6},
            {state: 'DC', name: 'Washington DC', coords: [38.9072, -77.0369], revenue: 27251, customers: 47, orders: 365, tier: 'Emerging', color: '#f59e0b', size: 6},
            {state: 'DE', name: 'Delaware', coords: [39.1582, -75.5244], revenue: 22735, customers: 17, orders: 170, tier: 'Emerging', color: '#f59e0b', size: 5},
            {state: 'TX', name: 'Texas', coords: [30.2672, -97.7431], revenue: 18823, customers: 27, orders: 136, tier: 'Emerging', color: '#f59e0b', size: 5},
            {state: 'WI', name: 'Wisconsin', coords: [43.0731, -89.4012], revenue: 14886, customers: 30, orders: 124, tier: 'Emerging', color: '#f59e0b', size: 4},
            {state: 'WV', name: 'West Virginia', coords: [38.3498, -81.6326], revenue: 13414, customers: 12, orders: 82, tier: 'Emerging', color: '#f59e0b', size: 4},
            {state: 'KY', name: 'Kentucky', coords: [38.2009, -84.2700], revenue: 12383, customers: 14, orders: 90, tier: 'Emerging', color: '#f59e0b', size: 4},
            {state: 'SC', name: 'South Carolina', coords: [34.0007, -81.0348], revenue: 10958, customers: 10, orders: 75, tier: 'Emerging', color: '#f59e0b', size: 4},
            
            // Test Markets
            {state: 'IN', name: 'Indiana', coords: [39.7684, -86.1581], revenue: 6776, customers: 16, orders: 73, tier: 'Test', color: '#6b7280', size: 3},
            {state: 'MO', name: 'Missouri', coords: [38.5767, -92.1735], revenue: 4322, customers: 12, orders: 30, tier: 'Test', color: '#6b7280', size: 3},
            {state: 'CA', name: 'California', coords: [36.7783, -119.4179], revenue: 2, customers: 2, orders: 9, tier: 'Test', color: '#6b7280', size: 2},
            {state: 'MS', name: 'Mississippi', coords: [32.3547, -89.3985], revenue: 0, customers: 0, orders: 1, tier: 'Test', color: '#6b7280', size: 2}
        ];

        nutreStates.forEach(function(state) {
            var marker = L.circleMarker(state.coords, {
                radius: state.size,
                fillColor: state.color,
                color: '#fff',
                weight: 3,
                opacity: 1,
                fillOpacity: 0.75
            }).addTo(map);

            var revenueFormatted = '$' + (state.revenue / 1000).toFixed(0) + 'K';
            if (state.revenue >= 1000000) {
                revenueFormatted = '$' + (state.revenue / 1000000).toFixed(2) + 'M';
            }
            
            var aov = state.orders > 0 ? (state.revenue / state.orders).toFixed(2) : '0.00';
            var ordersPerCustomer = state.customers > 0 ? (state.orders / state.customers).toFixed(1) : '0.0';
            var revPerCustomer = state.customers > 0 ? (state.revenue / state.customers).toFixed(0) : '0';

            var html = '<div class="popup-header">';
            html += '<div class="popup-state">' + state.name + '</div>';
            html += '<div class="popup-tier">' + state.tier + ' Market</div>';
            html += '</div>';
            
            html += '<div class="metric-grid">';
            html += '<div class="metric-box"><div class="metric-label">Revenue</div><div class="metric-value">' + revenueFormatted + '</div></div>';
            html += '<div class="metric-box"><div class="metric-label">Customers</div><div class="metric-value">' + state.customers.toLocaleString() + '</div></div>';
            html += '<div class="metric-box"><div class="metric-label">Orders</div><div class="metric-value">' + state.orders.toLocaleString() + '</div></div>';
            html += '<div class="metric-box"><div class="metric-label">AOV</div><div class="metric-value">$' + aov + '</div></div>';
            html += '</div>';
            
            html += '<div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #333; font-size: 12px; color: #9ca3af;">';
            html += 'Orders/Customer: <strong style="color: #fff;">' + ordersPerCustomer + '</strong><br>';
            html += 'Rev/Customer: <strong style="color: #fff;">$' + revPerCustomer + '</strong>';
            html += '</div>';

            marker.bindPopup(html, { maxWidth: 320 });
        });

        L.control.scale({position: 'bottomleft', imperial: true, metric: false}).addTo(map);
    </script>
</body>
</html>
